int fire[800];

void line_blur(int offset, int step, int nsteps) {
    int circ[3];
    circ[0] = 0;
    circ[1] = fire[offset];
    circ[2] = fire[offset + step];
    int beg;
    beg = 1;
    int i;
    i = 0;
    while (i < nsteps) {
        fire[offset] = (circ[0] + circ[1] + circ[2]) / 3;
        if ((i + 2) < nsteps)
            circ[(beg + 2) % 3] = fire[offset + 2 * step];
        else
            circ[(beg + 2) % 3] = 0;
        beg = beg + 1;
        offset = offset + step;
        i = i + 1;
    }
}

void palette(int i) {
    if (i == 0) print("\033[48;2;0;0;0m ");
    if (i == 1) print("\033[48;2;0;4;4m ");
    if (i == 2) print("\033[48;2;0;16;20m ");
    if (i == 3) print("\033[48;2;0;28;36m ");
    if (i == 4) print("\033[48;2;0;32;44m ");
    if (i == 5) print("\033[48;2;0;36;48m ");
    if (i == 6) print("\033[48;2;60;24;32m ");
    if (i == 7) print("\033[48;2;100;16;16m ");
    if (i == 8) print("\033[48;2;132;12;12m ");
    if (i == 9) print("\033[48;2;160;8;8m ");
    if (i == 10) print("\033[48;2;192;8;8m ");
    if (i == 11) print("\033[48;2;220;4;4m ");
    if (i == 12) print("\033[48;2;252;0;0m ");
    if (i == 13) print("\033[48;2;252;0;0m ");
    if (i == 14) print("\033[48;2;252;12;0m ");
    if (i == 15) print("\033[48;2;252;28;0m ");
    if (i == 16) print("\033[48;2;252;40;0m ");
    if (i == 17) print("\033[48;2;252;52;0m ");
    if (i == 18) print("\033[48;2;252;64;0m ");
    if (i == 19) print("\033[48;2;252;80;0m ");
    if (i == 20) print("\033[48;2;252;92;0m ");
    if (i == 21) print("\033[48;2;252;104;0m ");
    if (i == 22) print("\033[48;2;252;116;0m ");
    if (i == 23) print("\033[48;2;252;132;0m ");
    if (i == 24) print("\033[48;2;252;144;0m ");
    if (i == 25) print("\033[48;2;252;156;0m ");
    if (i == 26) print("\033[48;2;252;156;0m ");
    if (i == 27) print("\033[48;2;252;160;0m ");
    if (i == 28) print("\033[48;2;252;160;0m ");
    if (i == 29) print("\033[48;2;252;164;0m ");
    if (i == 30) print("\033[48;2;252;168;0m ");
    if (i == 31) print("\033[48;2;252;168;0m ");
    if (i == 32) print("\033[48;2;252;172;0m ");
    if (i == 33) print("\033[48;2;252;176;0m ");
    if (i == 34) print("\033[48;2;252;176;0m ");
    if (i == 35) print("\033[48;2;252;180;0m ");
    if (i == 36) print("\033[48;2;252;180;0m ");
    if (i == 37) print("\033[48;2;252;184;0m ");
    if (i == 38) print("\033[48;2;252;188;0m ");
    if (i == 39) print("\033[48;2;252;188;0m ");
    if (i == 40) print("\033[48;2;252;192;0m ");
    if (i == 41) print("\033[48;2;252;196;0m ");
    if (i == 42) print("\033[48;2;252;196;0m ");
    if (i == 43) print("\033[48;2;252;200;0m ");
    if (i == 44) print("\033[48;2;252;204;0m ");
    if (i == 45) print("\033[48;2;252;204;0m ");
    if (i == 46) print("\033[48;2;252;208;0m ");
    if (i == 47) print("\033[48;2;252;212;0m ");
    if (i == 48) print("\033[48;2;252;212;0m ");
    if (i == 49) print("\033[48;2;252;216;0m ");
    if (i == 50) print("\033[48;2;252;220;0m ");
    if (i == 51) print("\033[48;2;252;220;0m ");
    if (i == 52) print("\033[48;2;252;224;0m ");
    if (i == 53) print("\033[48;2;252;228;0m ");
    if (i == 54) print("\033[48;2;252;228;0m ");
    if (i == 55) print("\033[48;2;252;232;0m ");
    if (i == 56) print("\033[48;2;252;232;0m ");
    if (i == 57) print("\033[48;2;252;236;0m ");
    if (i == 58) print("\033[48;2;252;240;0m ");
    if (i == 59) print("\033[48;2;252;240;0m ");
    if (i == 60) print("\033[48;2;252;244;0m ");
    if (i == 61) print("\033[48;2;252;248;0m ");
    if (i == 62) print("\033[48;2;252;248;0m ");
    if (i == 63) print("\033[48;2;252;252;0m ");
    if (i == 64) print("\033[48;2;252;252;252m ");
    if (i == 65) print("\033[48;2;252;252;252m ");
    if (i == 66) print("\033[48;2;252;252;252m ");
    if (i == 67) print("\033[48;2;252;252;252m ");
    if (i == 68) print("\033[48;2;252;252;252m ");
    if (i == 69) print("\033[48;2;252;252;252m ");
    if (i == 70) print("\033[48;2;252;252;252m ");
    if (i == 71) print("\033[48;2;252;252;252m ");
    if (i == 72) print("\033[48;2;252;252;252m ");
    if (i == 73) print("\033[48;2;252;252;252m ");
    if (i == 74) print("\033[48;2;252;252;252m ");
    if (i == 75) print("\033[48;2;252;252;252m ");
    if (i == 76) print("\033[48;2;252;252;252m ");
    if (i == 77) print("\033[48;2;252;252;252m ");
    if (i == 78) print("\033[48;2;252;252;252m ");
    if (i == 79) print("\033[48;2;252;252;252m ");
    if (i == 80) print("\033[48;2;252;252;252m ");
    if (i == 81) print("\033[48;2;252;252;252m ");
    if (i == 82) print("\033[48;2;252;252;252m ");
    if (i == 83) print("\033[48;2;252;252;252m ");
    if (i == 84) print("\033[48;2;252;252;252m ");
    if (i == 85) print("\033[48;2;252;252;252m ");
    if (i == 86) print("\033[48;2;252;252;252m ");
    if (i == 87) print("\033[48;2;252;252;252m ");
    if (i == 88) print("\033[48;2;252;252;252m ");
    if (i == 89) print("\033[48;2;252;252;252m ");
    if (i == 90) print("\033[48;2;252;252;252m ");
    if (i == 91) print("\033[48;2;252;252;252m ");
    if (i == 92) print("\033[48;2;252;252;252m ");
    if (i == 93) print("\033[48;2;252;252;252m ");
    if (i == 94) print("\033[48;2;252;252;252m ");
    if (i == 95) print("\033[48;2;252;252;252m ");
    if (i == 96) print("\033[48;2;252;252;252m ");
    if (i == 97) print("\033[48;2;252;252;252m ");
    if (i == 98) print("\033[48;2;252;252;252m ");
    if (i == 99) print("\033[48;2;252;252;252m ");
    if (i == 100) print("\033[48;2;252;252;252m ");
    if (i == 101) print("\033[48;2;252;252;252m ");
    if (i == 102) print("\033[48;2;252;252;252m ");
    if (i == 103) print("\033[48;2;252;252;252m ");
    if (i == 104) print("\033[48;2;252;252;252m ");
    if (i == 105) print("\033[48;2;252;252;252m ");
    if (i == 106) print("\033[48;2;252;252;252m ");
    if (i == 107) print("\033[48;2;252;252;252m ");
    if (i == 108) print("\033[48;2;252;252;252m ");
    if (i == 109) print("\033[48;2;252;252;252m ");
    if (i == 110) print("\033[48;2;252;252;252m ");
    if (i == 111) print("\033[48;2;252;252;252m ");
    if (i == 112) print("\033[48;2;252;252;252m ");
    if (i == 113) print("\033[48;2;252;252;252m ");
    if (i == 114) print("\033[48;2;252;252;252m ");
    if (i == 115) print("\033[48;2;252;252;252m ");
    if (i == 116) print("\033[48;2;252;252;252m ");
    if (i == 117) print("\033[48;2;252;252;252m ");
    if (i == 118) print("\033[48;2;252;252;252m ");
    if (i == 119) print("\033[48;2;252;252;252m ");
    if (i == 120) print("\033[48;2;252;252;252m ");
    if (i == 121) print("\033[48;2;252;252;252m ");
    if (i == 122) print("\033[48;2;252;252;252m ");
    if (i == 123) print("\033[48;2;252;252;252m ");
    if (i == 124) print("\033[48;2;252;252;252m ");
    if (i == 125) print("\033[48;2;252;252;252m ");
    if (i == 126) print("\033[48;2;252;252;252m ");
    if (i == 127) print("\033[48;2;252;252;252m ");
    if (i == 128) print("\033[48;2;252;252;252m ");
    if (i == 129) print("\033[48;2;252;252;252m ");
    if (i == 130) print("\033[48;2;252;252;252m ");
    if (i == 131) print("\033[48;2;252;252;252m ");
    if (i == 132) print("\033[48;2;252;252;252m ");
    if (i == 133) print("\033[48;2;252;252;252m ");
    if (i == 134) print("\033[48;2;252;252;252m ");
    if (i == 135) print("\033[48;2;252;252;252m ");
    if (i == 136) print("\033[48;2;252;252;252m ");
    if (i == 137) print("\033[48;2;252;252;252m ");
    if (i == 138) print("\033[48;2;252;252;252m ");
    if (i == 139) print("\033[48;2;252;252;252m ");
    if (i == 140) print("\033[48;2;252;252;252m ");
    if (i == 141) print("\033[48;2;252;252;252m ");
    if (i == 142) print("\033[48;2;252;252;252m ");
    if (i == 143) print("\033[48;2;252;252;252m ");
    if (i == 144) print("\033[48;2;252;252;252m ");
    if (i == 145) print("\033[48;2;252;252;252m ");
    if (i == 146) print("\033[48;2;252;252;252m ");
    if (i == 147) print("\033[48;2;252;252;252m ");
    if (i == 148) print("\033[48;2;252;252;252m ");
    if (i == 149) print("\033[48;2;252;252;252m ");
    if (i == 150) print("\033[48;2;252;252;252m ");
    if (i == 151) print("\033[48;2;252;252;252m ");
    if (i == 152) print("\033[48;2;252;252;252m ");
    if (i == 153) print("\033[48;2;252;252;252m ");
    if (i == 154) print("\033[48;2;252;252;252m ");
    if (i == 155) print("\033[48;2;252;252;252m ");
    if (i == 156) print("\033[48;2;252;252;252m ");
    if (i == 157) print("\033[48;2;252;252;252m ");
    if (i == 158) print("\033[48;2;252;252;252m ");
    if (i == 159) print("\033[48;2;252;252;252m ");
    if (i == 160) print("\033[48;2;252;252;252m ");
    if (i == 161) print("\033[48;2;252;252;252m ");
    if (i == 162) print("\033[48;2;252;252;252m ");
    if (i == 163) print("\033[48;2;252;252;252m ");
    if (i == 164) print("\033[48;2;252;252;252m ");
    if (i == 165) print("\033[48;2;252;252;252m ");
    if (i == 166) print("\033[48;2;252;252;252m ");
    if (i == 167) print("\033[48;2;252;252;252m ");
    if (i == 168) print("\033[48;2;252;252;252m ");
    if (i == 169) print("\033[48;2;252;252;252m ");
    if (i == 170) print("\033[48;2;252;252;252m ");
    if (i == 171) print("\033[48;2;252;252;252m ");
    if (i == 172) print("\033[48;2;252;252;252m ");
    if (i == 173) print("\033[48;2;252;252;252m ");
    if (i == 174) print("\033[48;2;252;252;252m ");
    if (i == 175) print("\033[48;2;252;252;252m ");
    if (i == 176) print("\033[48;2;252;252;252m ");
    if (i == 177) print("\033[48;2;252;252;252m ");
    if (i == 178) print("\033[48;2;252;252;252m ");
    if (i == 179) print("\033[48;2;252;252;252m ");
    if (i == 180) print("\033[48;2;252;252;252m ");
    if (i == 181) print("\033[48;2;252;252;252m ");
    if (i == 182) print("\033[48;2;252;252;252m ");
    if (i == 183) print("\033[48;2;252;252;252m ");
    if (i == 184) print("\033[48;2;252;252;252m ");
    if (i == 185) print("\033[48;2;252;252;252m ");
    if (i == 186) print("\033[48;2;252;252;252m ");
    if (i == 187) print("\033[48;2;252;252;252m ");
    if (i == 188) print("\033[48;2;252;252;252m ");
    if (i == 189) print("\033[48;2;252;252;252m ");
    if (i == 190) print("\033[48;2;252;252;252m ");
    if (i == 191) print("\033[48;2;252;252;252m ");
    if (i == 192) print("\033[48;2;252;252;252m ");
    if (i == 193) print("\033[48;2;252;252;252m ");
    if (i == 194) print("\033[48;2;252;252;252m ");
    if (i == 195) print("\033[48;2;252;252;252m ");
    if (i == 196) print("\033[48;2;252;252;252m ");
    if (i == 197) print("\033[48;2;252;252;252m ");
    if (i == 198) print("\033[48;2;252;252;252m ");
    if (i == 199) print("\033[48;2;252;252;252m ");
    if (i == 200) print("\033[48;2;252;252;252m ");
    if (i == 201) print("\033[48;2;252;252;252m ");
    if (i == 202) print("\033[48;2;252;252;252m ");
    if (i == 203) print("\033[48;2;252;252;252m ");
    if (i == 204) print("\033[48;2;252;252;252m ");
    if (i == 205) print("\033[48;2;252;252;252m ");
    if (i == 206) print("\033[48;2;252;252;252m ");
    if (i == 207) print("\033[48;2;252;252;252m ");
    if (i == 208) print("\033[48;2;252;252;252m ");
    if (i == 209) print("\033[48;2;252;252;252m ");
    if (i == 210) print("\033[48;2;252;252;252m ");
    if (i == 211) print("\033[48;2;252;252;252m ");
    if (i == 212) print("\033[48;2;252;252;252m ");
    if (i == 213) print("\033[48;2;252;252;252m ");
    if (i == 214) print("\033[48;2;252;252;252m ");
    if (i == 215) print("\033[48;2;252;252;252m ");
    if (i == 216) print("\033[48;2;252;252;252m ");
    if (i == 217) print("\033[48;2;252;252;252m ");
    if (i == 218) print("\033[48;2;252;252;252m ");
    if (i == 219) print("\033[48;2;252;252;252m ");
    if (i == 220) print("\033[48;2;252;252;252m ");
    if (i == 221) print("\033[48;2;252;252;252m ");
    if (i == 222) print("\033[48;2;252;252;252m ");
    if (i == 223) print("\033[48;2;252;252;252m ");
    if (i == 224) print("\033[48;2;252;252;252m ");
    if (i == 225) print("\033[48;2;252;252;252m ");
    if (i == 226) print("\033[48;2;252;252;252m ");
    if (i == 227) print("\033[48;2;252;252;252m ");
    if (i == 228) print("\033[48;2;252;252;252m ");
    if (i == 229) print("\033[48;2;252;252;252m ");
    if (i == 230) print("\033[48;2;252;252;252m ");
    if (i == 231) print("\033[48;2;252;252;252m ");
    if (i == 232) print("\033[48;2;252;252;252m ");
    if (i == 233) print("\033[48;2;252;252;252m ");
    if (i == 234) print("\033[48;2;252;252;252m ");
    if (i == 235) print("\033[48;2;252;252;252m ");
    if (i == 236) print("\033[48;2;252;252;252m ");
    if (i == 237) print("\033[48;2;252;252;252m ");
    if (i == 238) print("\033[48;2;252;252;252m ");
    if (i == 239) print("\033[48;2;252;252;252m ");
    if (i == 240) print("\033[48;2;252;252;252m ");
    if (i == 241) print("\033[48;2;252;252;252m ");
    if (i == 242) print("\033[48;2;252;252;252m ");
    if (i == 243) print("\033[48;2;252;252;252m ");
    if (i == 244) print("\033[48;2;252;252;252m ");
    if (i == 245) print("\033[48;2;252;252;252m ");
    if (i == 246) print("\033[48;2;252;252;252m ");
    if (i == 247) print("\033[48;2;252;252;252m ");
    if (i == 248) print("\033[48;2;252;252;252m ");
    if (i == 249) print("\033[48;2;252;252;252m ");
    if (i == 250) print("\033[48;2;252;252;252m ");
    if (i == 251) print("\033[48;2;252;252;252m ");
    if (i == 252) print("\033[48;2;252;252;252m ");
    if (i == 253) print("\033[48;2;252;252;252m ");
    if (i == 254) print("\033[48;2;252;252;252m ");
    if (i == 255) print("\033[48;2;252;252;252m ");
}

int main() {
    int HEIGHT;
    HEIGHT = 10;
    int WIDTH;
    WIDTH = 80;

    int i;
    int j;

    j = 1;

    while (j < HEIGHT) {  // scroll up
        i = 0;
        while (i < WIDTH) {
            fire[i + j * WIDTH] = 0;
            i = i + 1;
        }
        j = j + 1;
    }

    while (true) {
        print("\033[2J");  // clear screen
        print("\033[H");   // home

        // j = 1;

        // while (j < HEIGHT) {  // scroll up
        //     i = 0;
        //     while (i < WIDTH) {
        //         fire[i + (j - 1) * WIDTH] = fire[i + j * WIDTH];
        //         i = i + 1;
        //     }
        //     j = j + 1;
        // }

        // j = 0;
        // while (j < HEIGHT) {
        //     line_blur(j * WIDTH, 1, WIDTH);
        //     j = j + 1;
        // }

        // i = 0;
        // while (i < WIDTH) {
        //     line_blur(i, WIDTH, HEIGHT);
        //     i = i + 1;
        // }

        i = 0;
        while (i < HEIGHT) {  // show the buffer
            j = 0;
            while (j < WIDTH) {
                palette(rand() % 255);
                j = j + 1;
            }
            print("\033[49m\n");
            i = i + 1;
        }
    }
    return 0;
}
